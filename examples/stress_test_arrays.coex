# Stress test: allocate, fill, and perform math on arrays of increasing sizes
# Reports on each successful iteration until something breaks

func test_size(_ size: int) -> int
    # Allocate and fill an array
    arr: List<int> = []
    i: int = 0
    for i in 0..size
        arr = arr.append(i)
    ~

    # Verify length
    if arr.len() != size
        print(-1)
        return -1
    ~

    # Sum all elements: sum of 0..n-1 = n*(n-1)/2
    sum: int = 0
    for x in arr
        sum = sum + x
    ~

    # Verify sum
    expected: int = size * (size - 1) / 2
    if sum != expected
        print(-2)
        return -2
    ~

    # Square each element and sum (test math operations)
    sq_sum: int = 0
    for x in arr
        sq_sum = sq_sum + (x * x)
    ~

    # Verify: sum of squares 0^2 + 1^2 + ... + (n-1)^2 = (n-1)*n*(2n-1)/6
    expected_sq: int = (size - 1) * size * (2 * size - 1) / 6
    if sq_sum != expected_sq
        print(-3)
        return -3
    ~

    return 0
~

func main() -> int
    print(10)
    result: int = test_size(10)
    if result != 0
        return result
    ~
    print(1)

    print(50)
    result = test_size(50)
    if result != 0
        return result
    ~
    print(1)

    print(100)
    result = test_size(100)
    if result != 0
        return result
    ~
    print(1)

    print(250)
    result = test_size(250)
    if result != 0
        return result
    ~
    print(1)

    print(500)
    result = test_size(500)
    if result != 0
        return result
    ~
    print(1)

    print(1000)
    result = test_size(1000)
    if result != 0
        return result
    ~
    print(1)

    print(2500)
    result = test_size(2500)
    if result != 0
        return result
    ~
    print(1)

    print(5000)
    result = test_size(5000)
    if result != 0
        return result
    ~
    print(1)

    print(10000)
    result = test_size(10000)
    if result != 0
        return result
    ~
    print(1)

    print(25000)
    result = test_size(25000)
    if result != 0
        return result
    ~
    print(1)

    print(50000)
    result = test_size(50000)
    if result != 0
        return result
    ~
    print(1)

    print(100000)
    result = test_size(100000)
    if result != 0
        return result
    ~
    print(1)

    return 0
~
